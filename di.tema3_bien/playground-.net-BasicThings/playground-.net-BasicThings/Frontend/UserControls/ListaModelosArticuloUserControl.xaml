<UserControl x:Class="playground_.net_BasicThings.Frontend.UserControls.ListaModelosArticuloUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:playground_.net_BasicThings.Frontend.UserControls"
             xmlns:mat="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800"
             Loaded="DiagListaModelosArticulos_Loaded"
             >
    <Grid>
        <DockPanel>
            <Grid DockPanel.Dock="Top">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                    </Grid.RowDefinitions>
                
                    <TextBlock Text="Lista Modelos Articulos"/>
                    <!-- Criterios -->
                    <StackPanel Orientation="Horizontal"
                                Grid.Row="1">
                        <TextBlock Text="FILTROS"
                                   Margin="10" VerticalAlignment="Center"
                                   Foreground="Black"/>
                        <TextBlock Text="Por Tipo de artículo"
                                   Margin="10,10,5,10" VerticalAlignment="Center"
                                   Foreground="Black"/>
                        <ComboBox DisplayMemberPath="Nombre"
                                  ItemsSource="{Binding listaTipoArticulos}"
                                  SelectedItem="{Binding tipoarticuloSeleccionado}"
                                  Style="{StaticResource MahApps.Styles.ComboBox}"
                                  Margin="0,10,10,10" mah:TextBoxHelper.Watermark="Selecciona un tipo"
                                  x:Name="cmbTipoArtipulo"
                                  SelectionChanged="cmbTipoArtipulo_SelectionChanged"/>
                        <TextBlock Text="Por Tipo de artículo"
                                   Margin="10,10,5,10" VerticalAlignment="Center"
                                   Foreground="Black"/>
                        <TextBox Width="200" Margin="0,10,5,10" Style="{StaticResource MahApps.Styles.TextBox}"
                                 mah:TextBoxHelper.Watermark="Escribe el nombre del modelo"
                                 Text="{Binding textoNombre, UpdateSourceTrigger=PropertyChanged}"
                                 x:Name="txtNombreModelo"
                                 TextChanged="txtNombreModelo_TextChanged"/>
                        <CheckBox Content="Mostrar solo modelos con 10 o mas artículos"
                                  Margin="10,10,10,10" VerticalAlignment="Center"
                                  IsChecked="{Binding soloModelosCon10Articulos}"
                                  Checked="CheckBox_Checked"
                                  Unchecked="CheckBox_Unchecked"/>
                        <Button Content="Limpiar Filtros"
                                Margin="10,10,10,10"
                                Padding="10,5"
                                x:Name="btnLimpiarFiltros"
                                Click="btnLimpiarFiltros_Click"
                                />
                    </StackPanel>
                    
                </Grid>
            </Grid>
            <Grid>
                <!-- Contenido -->
                <DataGrid 
                    SelectedItem="{Binding modeloArticulo}"
                    ItemsSource="{Binding listaModelosArticulo}"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    ColumnWidth="*">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Nombre" Binding="{Binding Nombre}" Width="*"/>
                        <DataGridTextColumn Header="Modelo" Binding="{Binding Modelo}" Width="*"/>
                        <DataGridTextColumn Header="Marca" Binding="{Binding Marca}" Width="*"/>
                        <DataGridTextColumn Header="Cantidad" Binding="{Binding Articulos.Count}" Width="*"/>
                        <DataGridTextColumn Header="Descripción" Binding="{Binding Descripcion}" Width="2*"/>
                    </DataGrid.Columns>
                    
                    <!-- Click Derecho opciones -->
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem 
                                Header="Editar modelo articulo"
                                x:Name="editarModeloArticulo"
                                Click="editarModeloArticulo_Click"/>
                            <MenuItem 
                                Header="Eliminar modelo articulo"
                                x:Name="eliminarModeloArticulo"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>

                    <DataGrid.RowDetailsTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <Grid DockPanel.Dock="Top">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Articulos de este modelo" Margin="10" Foreground="DarkViolet"/>
                                    <Button x:Name="btnCerrar" HorizontalAlignment="Right" Margin="10" Click="btnCerrar_Click" Grid.Column="1">
                                        <mat:PackIcon Kind="Close" />
                                    </Button>
                                </Grid>
                                <Grid>
                                    <DataGrid ItemsSource="{Binding Articulos}" CanUserAddRows="False" IsReadOnly="True" AutoGenerateColumns="False">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Numero de serie" Binding="{Binding Numserie}" Foreground="Violet"/>
                                            <DataGridTextColumn Header="Fecha alta" Binding="{Binding Fechaalta, StringFormat='dd/MM/yyyy'}" Foreground="Violet"/>
                                            <DataGridTextColumn Header="Estado" Binding="{Binding Estado}" Foreground="Violet"/>
                                            <DataGridTextColumn Header="Nombre espacio" Binding="{Binding EspacioNavigation.Nombre}" Foreground="Violet"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </DockPanel>
                        </DataTemplate>
                    </DataGrid.RowDetailsTemplate>
                </DataGrid>
            </Grid>
        </DockPanel>
    </Grid>
</UserControl>
